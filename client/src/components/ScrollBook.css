/* --- Premium 3D Book Styling --- */
.book-container {
  perspective: 2500px;
  width: 450px;
  height: 680px;
  position: relative;
  transform-style: preserve-3d;
  transition: width 1.2s cubic-bezier(0.25, 1, 0.5, 1), height 1.2s cubic-bezier(0.25, 1, 0.5, 1);
  margin: auto;
  z-index: 100;
  pointer-events: none; /* Disable events on container to avoid blocking */
}

.book {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
  /* Transition moved to .open state to avoid conflict with JS tilt */
  transform-origin: left;
  pointer-events: none; 
}

/* --- Closed State --- */
.book-container.closed .book {
  /* Transform handled by JS for mouse tilt effect */
  transition: none; /* Critical: Disable CSS transition for smooth JS lerp */
  box-shadow: 20px 30px 50px rgba(0,0,0,0.5);
}

/* Hover effect removed as it's replaced by continuous mouse tracking */
.book-container.closed:hover .book {
  box-shadow: 0 20px 40px rgba(0,0,0,0.6);
}

/* --- Open State --- */
.book-container.open {
  width: 1100px;
  max-width: 96vw;
  height: 90vh;
  max-height: 850px;
}

.book-container.open .book {
  transform: translateX(450px) rotateX(0deg);
  transition: transform 1.2s cubic-bezier(0.25, 1, 0.5, 1);
}

@media (max-width: 950px) {
  .book-container.open {
    width: 100%;
  }
  .book-container.open .book {
    transform: translateX(50%);
  }
}

.book-container.open .book-cover {
  transform: rotateY(-180deg);
}

/* --- Cover Design (Leather & Gold) --- */
.book-cover {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  transform-origin: left;
  transform-style: preserve-3d;
  z-index: 20;
  transition: transform 1.2s cubic-bezier(0.25, 1, 0.5, 1);
  pointer-events: none; /* Cover itself shouldn't block, only content */
}

.cover-front {
  position: absolute;
  width: 100%;
  height: 100%;
  /* Leather Texture Effect */
  background-color: #1a1528;
  background-image: 
    /* Hinge Gradient (Left Side) */
    linear-gradient(90deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.4) 2%, rgba(0,0,0,0.1) 4%, transparent 6%),
    /* Texture */
    radial-gradient(circle at 50% 0%, rgba(255,255,255,0.1) 0%, transparent 60%),
    url("data:image/svg+xml,%3Csvg width='200' height='200' viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
  
  /* Geometry Fix: Left radius 0 to sit flush with spine */
  border-radius: 0 12px 12px 0;
  box-shadow: 
    inset 3px 0 10px rgba(0,0,0,0.8), /* Spine shadow */
    inset 0 0 30px rgba(60, 20, 100, 0.3), /* Color glow */
    5px 5px 15px rgba(0,0,0,0.3);
    
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(255,255,255,0.05);
  border-left: none; /* Remove border at spine junction */
  
  /* Shift cover slightly right to be "inside" the spine hinge */
  left: 2px;
  width: calc(100% - 2px);
  
  /* Gold Border Inlay */
  outline: 2px solid #c0a060;
  outline-offset: -15px;
  
  backface-visibility: hidden; /* Restore for performance, but ensure content is above */
}

/* Fix visibility issues */
.book-skin {
  width: 100%;
  height: 100%;
  padding: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transform: translateZ(1px); /* Reduced to 1px to be "on" the cover, not floating */
  z-index: 1000; /* Very High z-index */
  pointer-events: auto !important; /* Force enable interaction */
  position: relative;
}

.cover-back {
  position: absolute;
  width: 100%;
  height: 100%;
  background: #1a1528;
  transform: rotateY(180deg) translateZ(1px);
  border-radius: 12px 4px 4px 12px;
}

/* --- Spine Design --- */
.book-spine {
  position: absolute;
  width: 50px;
  height: 100%;
  background: #151020;
  /* 
     Geometry Fix:
     - Anchor at left: 0
     - Rotate -90deg around Y axis (folding "in")
     - This places the spine starting at x=0, z=0 and extending to x=0, z=-50
  */
  transform-origin: left;
  transform: rotateY(-90deg);
  left: 0;
  
  /* Spine Ridges */
  background-image: 
    linear-gradient(to bottom, 
      transparent 5%, rgba(0,0,0,0.3) 5%, rgba(0,0,0,0.3) 6%, transparent 6%,
      transparent 15%, rgba(0,0,0,0.3) 15%, rgba(0,0,0,0.3) 16%, transparent 16%,
      transparent 85%, rgba(0,0,0,0.3) 85%, rgba(0,0,0,0.3) 86%, transparent 86%,
      transparent 95%, rgba(0,0,0,0.3) 95%, rgba(0,0,0,0.3) 96%, transparent 96%
    );
  box-shadow: inset 0 0 15px rgba(0,0,0,0.8);
}

.book-back {
  position: absolute;
  width: 100%;
  height: 100%;
  background: #1a1528;
  /* 
     Geometry Fix:
     - Push back by exactly the spine width (50px)
  */
  transform: translateZ(-50px);
  border-radius: 4px 12px 12px 4px;
  box-shadow: -10px 10px 30px rgba(0,0,0,0.5);
}

/* --- Pages Texture --- */
.book-pages {
  position: absolute;
  width: 98%;
  height: 96%;
  top: 2%;
  left: 0;
  background: #f1f5f9;
  transform: translateZ(-25px);
  /* Realistic Page Lines */
  background-image: repeating-linear-gradient(to right, #e2e8f0 0px, #e2e8f0 1px, #f8fafc 1px, #f8fafc 4px);
  box-shadow: 
    inset 0 0 30px rgba(0,0,0,0.1),
    5px 0 15px rgba(0,0,0,0.1);
  display: flex;
  overflow: hidden;
  border-radius: 2px 8px 8px 2px;
  pointer-events: auto !important; /* Force enable interaction */
}

/* Ensure pages don't block cover when closed */
.book-container.closed .book-pages {
  pointer-events: none !important;
}
